[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid

[program:sandbox-init]
command=/usr/local/bin/start-sandbox.sh
directory=/data
autostart=true
autorestart=true
startretries=3
startsecs=10
stdout_logfile=/var/log/sandbox-init.log
stderr_logfile=/var/log/sandbox-init-error.log
environment=CONTRACTS_DIR="/app/contracts",RUST_LOG="info",SANDBOX_HOME="/data/sandbox"
priority=100

[program:rpc-proxy]
command=/bin/bash -c "sleep 15 && exec socat TCP-LISTEN:3030,fork,reuseaddr TCP:127.0.0.1:3031"
autostart=true
autorestart=true
startretries=10
startsecs=5
stdout_logfile=/var/log/rpc-proxy.log
stderr_logfile=/var/log/rpc-proxy-error.log
priority=200

[program:bulk-payment-api]
command=/usr/local/bin/bulk-payment-api
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=5
stdout_logfile=/var/log/bulk-payment-api.log
stderr_logfile=/var/log/bulk-payment-api-error.log
environment=NEAR_RPC_URL="http://localhost:3031",BULK_PAYMENT_CONTRACT_ID="bulk-payment.near",API_PORT="8080",NEAR_SIGNER_PRIVATE_KEY="ed25519:Mb4FS43HbvYHgFwq4BVkxPd1vktFVXEd7AEEZANdM6UUniZvcdHT9yZ6QmmwDPbeDh5esR5NLCmRA3hRy9jaunG",WORKER_CALLER_ID="bulk-payment.near"
priority=300

[program:sputnik-indexer]
command=/usr/local/bin/sputnik-indexer
directory=/app
autostart=true
autorestart=true
startretries=3
startsecs=5
stdout_logfile=/var/log/sputnik-indexer.log
stderr_logfile=/var/log/sputnik-indexer-error.log
environment=NEAR_RPC_URL="http://localhost:3031",PORT="5001",ROCKET_ADDRESS="0.0.0.0",ROCKET_PORT="5001"
priority=300
